# 概率与统计基础 / Probability and Statistics Fundamentals

## 目录 (Table of Contents)

- [概率与统计基础 / Probability and Statistics Fundamentals](#概率与统计基础--probability-and-statistics-fundamentals)
  - [目录 (Table of Contents)](#目录-table-of-contents)
  - [概述 / Overview](#概述--overview)
  - [概率空间 / Probability Space](#概率空间--probability-space)
  - [随机变量与分布 / Random Variables and Distributions](#随机变量与分布--random-variables-and-distributions)
  - [期望与方差 / Expectation and Variance](#期望与方差--expectation-and-variance)
  - [大数与中心极限定理 / LLN and CLT](#大数与中心极限定理--lln-and-clt)
  - [集中不等式 / Concentration Inequalities](#集中不等式--concentration-inequalities)
  - [蒙特卡洛与采样 / Monte Carlo and Sampling](#蒙特卡洛与采样--monte-carlo-and-sampling)
  - [估计与置信区间 / Estimation and Confidence Intervals](#估计与置信区间--estimation-and-confidence-intervals)
  - [随机算法中的应用 / Applications in Randomized Algorithms](#随机算法中的应用--applications-in-randomized-algorithms)
  - [参考文献 / References](#参考文献--references)
  - [术语对照表 / Terminology Reference](#术语对照表--terminology-reference)
  - [练习与习题 / Exercises and Problems](#练习与习题--exercises-and-problems)
    - [基础练习 / Basic Exercises](#基础练习--basic-exercises)
    - [进阶练习 / Advanced Exercises](#进阶练习--advanced-exercises)
    - [编程练习 / Programming Exercises](#编程练习--programming-exercises)
    - [应用练习 / Application Exercises](#应用练习--application-exercises)

## 概述 / Overview

概率与统计为随机算法、学习理论与复杂度分析提供数学基础。本章覆盖概率空间、随机变量、期望与方差、常见分布、集中不等式与采样方法。

Probability and statistics provide the mathematical foundations for randomized algorithms, learning theory, and complexity analysis. This chapter covers probability spaces, random variables, expectation and variance, common distributions, concentration inequalities, and sampling methods.

## 概率空间 / Probability Space

**定义 1.1** 概率空间为三元组 $(\Omega, \mathcal{F}, \mathbb{P})$，其中样本空间 $\Omega$、事件域 $\mathcal{F}$ 与概率测度 $\mathbb{P}$。

A probability space is a triple $(\Omega, \mathcal{F}, \mathbb{P})$ with sample space $\Omega$, sigma-algebra $\mathcal{F}$, and probability measure $\mathbb{P}$.

## 随机变量与分布 / Random Variables and Distributions

- 随机变量 Random variable: $X: (\Omega, \mathcal{F}) \to (\mathbb{R}, \mathcal{B})$
- 分布函数 CDF: $F_X(x) = \mathbb{P}(X \le x)$; 概率密度 PDF（连续情形）
- 常见分布：伯努利、二项、泊松、几何；均匀、高斯、指数、伽马

## 期望与方差 / Expectation and Variance

- 期望 Expectation: $\mathbb{E}[X]$
- 方差 Variance: $\mathrm{Var}(X)=\mathbb{E}[(X-\mathbb{E}[X])^2]$
- 线性性 Linearity: $\mathbb{E}[\sum_i a_i X_i] = \sum_i a_i \mathbb{E}[X_i]$
- 全期望/全方差定理 Law of Total Expectation/Variance

## 大数与中心极限定理 / LLN and CLT

- 大数定律 LLN: 样本均值收敛于期望
- 中心极限定理 CLT: 归一化和趋于高斯分布

## 集中不等式 / Concentration Inequalities

- 马尔可夫 Markov: $\mathbb{P}(X \ge a) \le \mathbb{E}[X]/a$
- 切比雪夫 Chebyshev: $\mathbb{P}(|X-\mu|\ge k\sigma) \le 1/k^2$
- Hoeffding: 独立有界随机变量之和的尾界
- Chernoff: 伯努利和/二项的指数尾界

```python
# Hoeffding 不等式给定样本对均值偏差的上界
import math

def hoeffding_bound(n, R, eps):
    # n: 样本数，R: 每个样本取值范围宽度（b-a），eps: 偏差
    return math.exp(-2*n*eps*eps/(R*R))
```

## 蒙特卡洛与采样 / Monte Carlo and Sampling

- 独立同分布采样 IID sampling
- 拒绝采样 Rejection sampling
- 重要性采样 Importance sampling
- MCMC（Metropolis-Hastings、Gibbs）

```python
# 拒绝采样：从目标密度（未归一化）采样
import random, math

def rejection_sampling(unnormalized_log_pdf, proposal_sampler, log_M):
    while True:
        x = proposal_sampler()
        # 比较 u <= target(x)/(M*proposal(x)) 的对数等价
        u = random.random()
        if math.log(u) <= unnormalized_log_pdf(x) - log_M:
            return x
```

## 估计与置信区间 / Estimation and Confidence Intervals

- 点估计与无偏性、方差与均方误差
- 区间估计：正态均值已知/未知方差，二项比例的正态近似与Clopper-Pearson

## 随机算法中的应用 / Applications in Randomized Algorithms

- 随机化快速选择/快速排序的期望复杂度
- 随机图算法与阈值现象
- 布隆过滤器与哈希分析（负载、冲突概率）

```python
# 随机化快速选择（期望线性）
import random

def randomized_select(arr, k):
    if len(arr) == 1:
        return arr[0]
    pivot = random.choice(arr)
    left = [x for x in arr if x < pivot]
    mid = [x for x in arr if x == pivot]
    right = [x for x in arr if x > pivot]
    if k < len(left):
        return randomized_select(left, k)
    elif k < len(left) + len(mid):
        return pivot
    else:
        return randomized_select(right, k - len(left) - len(mid))
```

## 参考文献 / References

1. Williams, Probability with Martingales
2. Grimmett & Stirzaker, Probability and Random Processes
3. Wasserman, All of Statistics
4. Vershynin, High-Dimensional Probability

## 术语对照表 / Terminology Reference

| 中文术语 | English Term | 定义/说明 |
|---------|-------------|----------|
| 概率空间 | Probability Space | $(\Omega, \mathcal{F}, \mathbb{P})$ 三元组 |
| 随机变量 | Random Variable | $X: \Omega \to \mathbb{R}$ 的可测函数 |
| 分布函数 | Cumulative Distribution Function | $F_X(x) = \mathbb{P}(X \le x)$ |
| 概率密度 | Probability Density Function | 连续随机变量的导数 $f_X(x) = F_X'(x)$ |
| 期望 | Expectation | $\mathbb{E}[X] = \int x dF_X(x)$ |
| 方差 | Variance | $\text{Var}(X) = \mathbb{E}[(X-\mathbb{E}[X])^2]$ |
| 协方差 | Covariance | $\text{Cov}(X,Y) = \mathbb{E}[(X-\mathbb{E}[X])(Y-\mathbb{E}[Y])]$ |
| 大数定律 | Law of Large Numbers | 样本均值收敛于期望 |
| 中心极限定理 | Central Limit Theorem | 归一化和趋于正态分布 |
| 马尔可夫不等式 | Markov's Inequality | $\mathbb{P}(X \ge a) \le \mathbb{E}[X]/a$ |
| 切比雪夫不等式 | Chebyshev's Inequality | $\mathbb{P}(\|X-\mu\|\ge k\sigma) \le 1/k^2$ |
| 霍夫丁不等式 | Hoeffding's Inequality | 有界随机变量和的尾界 |
| 蒙特卡洛方法 | Monte Carlo Method | 基于随机采样的数值方法 |

## 练习与习题 / Exercises and Problems

### 基础练习 / Basic Exercises

**练习 1.1** / **Exercise 1.1**
证明：对于任意随机变量 $X$，有 $\text{Var}(X) = \mathbb{E}[X^2] - (\mathbb{E}[X])^2$。

Prove: For any random variable $X$, we have $\text{Var}(X) = \mathbb{E}[X^2] - (\mathbb{E}[X])^2$.

**练习 1.2** / **Exercise 1.2**
计算二项分布 $B(n,p)$ 的期望和方差。

Calculate the expectation and variance of the binomial distribution $B(n,p)$.

**练习 1.3** / **Exercise 1.3**
证明：如果 $X$ 和 $Y$ 独立，则 $\text{Cov}(X,Y) = 0$。

Prove: If $X$ and $Y$ are independent, then $\text{Cov}(X,Y) = 0$.

### 进阶练习 / Advanced Exercises

**练习 2.1** / **Exercise 2.1**
使用切比雪夫不等式证明大数定律。

Use Chebyshev's inequality to prove the law of large numbers.

**练习 2.2** / **Exercise 2.2**
证明：对于独立同分布的随机变量 $X_1, \ldots, X_n$，样本均值 $\bar{X} = \frac{1}{n}\sum_{i=1}^n X_i$ 的方差为 $\text{Var}(\bar{X}) = \frac{\text{Var}(X_1)}{n}$。

Prove: For i.i.d. random variables $X_1, \ldots, X_n$, the variance of the sample mean $\bar{X} = \frac{1}{n}\sum_{i=1}^n X_i$ is $\text{Var}(\bar{X}) = \frac{\text{Var}(X_1)}{n}$.

**练习 2.3** / **Exercise 2.3**
使用霍夫丁不等式分析随机化算法的错误概率。

Use Hoeffding's inequality to analyze the error probability of randomized algorithms.

### 编程练习 / Programming Exercises

**练习 3.1** / **Exercise 3.1**
实现拒绝采样算法，从给定的概率密度函数中采样。

Implement rejection sampling to sample from a given probability density function.

**练习 3.2** / **Exercise 3.2**
实现蒙特卡洛积分方法，计算定积分 $\int_a^b f(x) dx$。

Implement Monte Carlo integration to compute the definite integral $\int_a^b f(x) dx$.

**练习 3.3** / **Exercise 3.3**
实现随机化快速排序算法，并分析其期望时间复杂度。

Implement randomized quicksort and analyze its expected time complexity.

### 应用练习 / Application Exercises

**练习 4.1** / **Exercise 4.1**
使用概率方法证明：在 $n$ 个顶点的图中，存在大小为 $\Omega(\log n)$ 的独立集。

Use the probabilistic method to prove: In a graph with $n$ vertices, there exists an independent set of size $\Omega(\log n)$.

**练习 4.2** / **Exercise 4.2**
设计一个随机化算法来估计网络中的节点数量，并分析其精度。

Design a randomized algorithm to estimate the number of nodes in a network and analyze its accuracy.

**练习 4.3** / **Exercise 4.3**
实现布隆过滤器，并分析其假阳性概率。

Implement a Bloom filter and analyze its false positive probability.
